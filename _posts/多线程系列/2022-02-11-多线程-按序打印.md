---
layout: post
title:  "多线程-按序打印"
date:   2022-02-11 18:25:34 +0800
categories: multi-thread
---

## 按序打印
[https://leetcode-cn.com/problems/print-in-order](https://leetcode-cn.com/problems/print-in-order)

### 问题描述
```
我们提供了一个类：

public class Foo {
  public void first() { print("first"); }
  public void second() { print("second"); }
  public void third() { print("third"); }
}
三个不同的线程 A、B、C 将会共用一个 Foo 实例。

一个将会调用 first() 方法
一个将会调用 second() 方法
还有一个将会调用 third() 方法
请设计修改程序，以确保 second() 方法在 first() 方法之后被执行，
third() 方法在 second() 方法之后被执行。
```
### 代码
```
class Foo {
    Lock lock;
    Condition f;
    Condition s;
    Condition t;
    volatile int num = 1;
    public Foo() {
        lock = new ReentrantLock();
        f = lock.newCondition();
        s = lock.newCondition();
        t = lock.newCondition();
    }

    public void first(Runnable printFirst) throws InterruptedException {
        lock.lock();
        try {
            while (num != 1) {
                f.await();
            }
            printFirst.run();
            num++;
            s.signal();
        } finally {
            lock.unlock();
        }
        
    }

    public void second(Runnable printSecond) throws InterruptedException {
        lock.lock();
        try {
            
            while (num != 2) { // 
                s.await();
            }
            printSecond.run();
            num++;
            t.signal();
        } finally {
            lock.unlock();
        }
        
    }

    public void third(Runnable printThird) throws InterruptedException {
        lock.lock();
        try {
            while (num != 3) {
                t.await();
            }
            printThird.run();
            num = 1;
            f.signal();
        } finally {
            lock.unlock();
        }
        
    }
}
```